#!/bin/bash
set -e

existing_packages=$(npm -g ls --depth=0)

PACKAGES=()
function __add_package() {
  PACKAGES+=($1)
}
function __ensure_package_installed() {
  if [ "$(echo "$existing_packages" | grep -v "$1")" == "$existing_packages" ]; then
    __add_package "$1"
  fi
}

# ----------------------
# | Add packages below |
# ----------------------

__ensure_package_installed "diff-so-fancy"
__ensure_package_installed "gitbook-cli"
__ensure_package_installed "git-guilt"
__ensure_package_installed "eslint"
__ensure_package_installed "lighthouse"
__ensure_package_installed "spoof"
__ensure_package_installed "grunt-cli"
__ensure_package_installed "gulp-cli"
__ensure_package_installed "ember-cli"
__ensure_package_installed "broccoli-cli"
__ensure_package_installed "phantomjs-prebuilt"
__ensure_package_installed "firebase-tools"

# ------------------------
# | Done adding packages |
# ------------------------

if [ ${#PACKAGES[@]} -eq 0 ]; then
  cat <<MSG

PACKAGES: none

MSG
else
  cat <<MSG

PACKAGES: ${PACKAGES[@]}

MSG
fi

npm install -g npm@latest yarn@latest "${PACKAGES[@]}"

