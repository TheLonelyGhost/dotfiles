#!/bin/bash
set -e

brew update

brew bundle --file=- <<EOF
# NOTE: Casks up front so we'll be prompted by sudo right away, then wait for rest of user-scoped installations

# Default GUI workstation
cask "dropbox"
cask "google-chrome"
cask "vagrant"
cask "virtualbox"
cask "iterm2"
cask "docker"
cask "telegram"
cask "evernote"

# Extra package repositories
tap "thoughtbot/formulae"
tap "homebrew/services"
tap "homebrew/dupes"
tap "caskroom/cask"
tap "neovim/neovim"

# Unix
brew "tree"
brew "ctags"
brew "git"
brew "openssl"
brew "rcm"
brew "reattach-to-user-namespace"
brew "the_silver_searcher"
brew "tmux"
brew "neovim"
brew "direnv"
brew "zsh"
brew "gpg-agent"
brew "gnupg"
brew "keychain"
brew "tree"
brew "watch"
brew "dos2unix"

# Fix MacOS with GNU
brew "ed"
brew "coreutils"
brew "binutils"
brew "gnutls"
brew "gzip"
brew "wget"
brew "bash"
brew "bash-completion"
brew "make"
brew "less"
brew "openssh"
brew "rsync"
brew "unzip"
brew "findutils", args: ['with-default-names']
brew "gnu-sed", args: ['with-default-names']
brew "gnu-tar", args: ['with-default-names']
brew "gnu-which", args: ['with-default-names']
brew "grep", args: ['with-default-names']
brew "vim", args: ['with-override-system-vi']

# Image manipulation
brew "imagemagick"

# Backup utils
brew "rclone"
brew "hub"

# Testing
brew "qt"
brew "phantomjs"
brew "mitmproxy"

# Programming languages
brew "libyaml" # should come after openssl
brew "node"
brew "python" # because MacOS using Python 2.6 is unacceptable
brew "python3" # needed for git-fixup

# Databases
brew "postgres", restart_service: true
brew "redis", restart_service: true
brew "mongodb", restart_service: true
EOF
