#!/bin/bash
set -e

PACKAGES=""
function __add_package() {
  PACKAGES="$1 $PACKAGES"
}
UPDATE_PACKAGES=""
function __update_package() {
  UPDATE_PACKAGES="$1 $UPDATE_PACKAGES"
}
PREINSTALL_PKGS=""
function __add_pre_package() {
  PREINSTALL_PKGS="$1 $PREINSTALL_PKGS"
}
RM_PACKAGES=""
function __rm_package() {
  RM_PACKAGES="$1 $RM_PACKAGES"
}

function __add_apm() {
  [ -e "$HOME"/.atom/packages/"$1" ] && __update_package "$1" || __add_package "$1"
}


# ----------------------
# | Add packages below |
# ----------------------

__add_apm "language-salesforce"
__add_apm "atom-force"
__add_apm "busy-signal"
__add_apm "linter"
__add_apm "editorconfig"

# ------------------------
# | Done adding packages |
# ------------------------

if [ "X$PACKAGES" != "X" ]; then
  apm install --no-confirm $PACKAGES
fi

if [ "X$UPDATE_PACKAGES" != "X" ]; then
  apm upgrade --no-confirm $UPDATE_PACKAGES
fi
