#!/bin/bash
set -e

PACKAGES=()
function __add_package() {
  PACKAGES+=($1)
}
UPDATE_PACKAGES=()
function __update_package() {
  UPDATE_PACKAGES+=($1)
}
PREINSTALL_PKGS=()
function __add_pre_package() {
  PREINSTALL_PKGS+=($1)
}
RM_PACKAGES=()
function __rm_package() {
  RM_PACKAGES+=($1)
}

function __add_apm() {
  if [ -e "${HOME}/.atom/packages/${1}" ]; then
    __update_package "$1"
  else
    __add_package "$1"
  fi
}


# ----------------------
# | Add packages below |
# ----------------------

__add_apm "language-salesforce"
__add_apm "atom-force"
__add_apm "busy-signal"
__add_apm "linter"
__add_apm "editorconfig"

# ------------------------
# | Done adding packages |
# ------------------------

if [ ! ${#PACKAGES[@]} -eq 0 ]; then
  apm install --no-confirm "${PACKAGES[@]}"
fi

if [ ! ${#UPDATE_PACKAGES[@]} -eq 0 ]; then
  apm upgrade --no-confirm "${UPDATE_PACKAGES[@]}"
fi
